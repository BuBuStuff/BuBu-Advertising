<head>
  <title>Display Page - BuBu Advertizing</title>
  <meta name="description" content="BuBu Advertizing - Non-Commercial Advertizing. We hate Chromebooks. Software powered by caffeine, delayed by school.">
</head>
<body>
  <a id="setURL" target="_blank">
    <img src id="adImgTag">
  </a>
  <p></p>
  <script src="scripts/asc.js">console.log("Database loaded");</script>
  <script>
    console.log("%cRead the BuBu Advertising documentation at https://github.com/BuBuStuff/BuBu-Advertising/wiki", "background-color: red; color: white;text-shadow: 3px 3px 0 rgb(217,31,38) , 6px 6px 0 rgb(226,91,14) , 9px 9px 0 rgb(245,221,8) , 12px 12px 0 rgb(5,148,68) , 15px 15px 0 rgb(2,135,206) , 18px 18px 0 rgb(4,77,145) , 21px 21px 0 rgb(42,21,113)");
    var params = (new URL(document.location)).searchParams;
    var adImg = params.get("img") + ".png";
    var adType = params.get("type"); // banner, large_box
    console.log("Params: " + params);
    console.log("Image: " + adImg + " (" + adType + ")");
    
    function getURL(imgURLinput) {
      if (adType == "banner") {
        var ascEntry = asc_banner.find(item => item.image === imgURLinput);
      } else {
        if (adType == "large_box") {
            var ascEntry = asc_large_box.find(item => item.image === imgURLinput);
        }
      }
      
      return ascEntry ? ascEntry.url : null; 
    }
    
    function setImg() {
      var imgDOM = document.getElementById("adImgTag");
      var urlTag = document.getElementById("setURL");
      var imgURL = getURL(adImg);
      console.log("Associated URL: " + imgURL);
      imgDOM.src = "media/" + adType + "/" + adImg;
      console.log("Image set");
      urlTag.href = imgURL;
      console.log("URL set");      
      if (imgURL.includes("javascript:")) {
        console.log("JavaScript URL detected");
        urlTag.removeAttribute("target");
      }
      document.title = adType + "/" + adImg + " - BuBu Advertizing";
      console.log("Document title set");
    }
     setImg();
    console.log("Operation complete");
  </script>
</body>
